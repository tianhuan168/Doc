### redis主从复制
---

### 概述

- redis的复制功能是支持多个数据库之间的数据同步。

    一类是主数据库（master）一类是从数据库（slave），主数据库可以进行读写操作，当发生写操作的时候自动将数据同步到从数据库，而从数据库一般是只读的，并接收主数据库同步过来的数据，
一个主数据库可以有多个从数据库，而一个从数据库只能有一个主数据库。
- 通过redis的复制功能可以很好的实现数据库的读写分离，提高服务器的负载能力。主数据库主要进行写操作，而从数据库负责读操作。

### 主从复制过程

主从复制过程：见下图

![image](https://github.com/tianhuan168/Doc/raw/master/img/3.jpg)

过程：

- 当一个从数据库启动时，会向主数据库发送sync命令，

- 主数据库接收到sync命令后会开始在后台保存快照（执行rdb操作），并将保存期间接收到的命令缓存起来

- 当快照完成后，redis会将快照文件和所有缓存的命令发送给从数据库。

- 从数据库收到后，会载入快照文件并执行收到的缓存的命令。


配置
 
Redis主从结构支持一主多从

主节点：192.168.33.130

从节点：192.168.33.131

注意：所有从节点的配置都一样 

----

#### 方式1：手动修改配置文件

只需要额外修改从节点中redis的配置文件中的slaveof属性即可

slaveof 192.168.33.130 6379
配置修改图示： 

![image](https://github.com/tianhuan168/Doc/raw/master/img/4.jpg)

#### 方式2：动态设置
通过redis-cli 连接到从节点服务器，执行下面命令即可。
slaveof 192.168.33.130 6379
